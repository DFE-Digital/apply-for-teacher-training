name: Maintenance V2 (Centralized)
on:
  workflow_dispatch:
    inputs:
      environment:
        required: true
        type: choice
        options:
        - development
        - test
        - production
      mode:
        required: true
        type: choice
        options:
        - enable
        - disable

jobs:
  set-maintenance-mode:
    name: Set maintenance mode (centralized)
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Enable or disable maintenance mode
      uses: DFE-Digital/github-actions/maintenance@2392-spike-centralise-maintenance-page
      with:
        # Azure authentication
        azure-client-id: ${{ secrets.AZURE_CLIENT_ID }}
        azure-subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
        azure-tenant-id: ${{ secrets.AZURE_TENANT_ID }}
        
        # Core configuration
        environment: ${{ inputs.environment }}
        mode: ${{ inputs.mode }}
        docker-repository: ghcr.io/dfe-digital/apply-for-teacher-training-maintenance
        github-token: ${{ secrets.GITHUB_TOKEN }}
        
        # Service customization
        service-name: "Apply for teacher training"
        maintenance-message: "We are currently carrying out essential maintenance. Please try again later."
        contact-email: "becomingateacher@digital.education.gov.uk"
        # estimated-return-time: "15:00"  # Optional - uncomment if needed
        # status-page-url: "https://status.example.com"  # Optional
        
        # Use your spike branch for templates
        template-ref: "2392-spike-centralise-maintenance-page"