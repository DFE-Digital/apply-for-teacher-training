<% content_for :browser_title,
   title_with_error_prefix('Your email has not been sent- Send Notify template - Settings',
   errors: true) %>
<% content_for :before_content, govuk_back_link_to(support_interface_notify_template_path) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-l">Your email has not been sent</h1>

    <p class="govuk-body">
      Remove or correct the following email addresses and upload the distribution list again:
    </p>

    <h2 class="govuk-heading-m"><%= @form.distribution_list.original_filename %></h2>

    <%= govuk_table do |table| %>
      <% table.with_head do |head| %>
        <% head.with_row do |row| %>
          <% row.with_cell text: 'Line number' %>
          <% row.with_cell text: 'Email address' %>
        <% end %>
      <% end %>

      <% table.with_body do |body| %>
        <% @form.invalid_email_address_rows.each do |invalid_email_address_row| %>
          <% body.with_row(html_attributes: { id: "row_#{invalid_email_address_row[:row_number]}" }) do |row| %>
            <% row.with_cell(text: invalid_email_address_row[:row_number]) %>

            <% row.with_cell do %>
              <p>
                <%= invalid_email_address_row[:email_address] %>
              </p>
            <% end %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>

    <p class="govuk-body govuk-!-text-align-centre secondary-text">
      Only showing rows with errors
    </p>

    <%= govuk_button_link_to 'Upload the file again', support_interface_notify_template_path %>
  </div>
</div>
