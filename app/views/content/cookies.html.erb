<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <h1 class="govuk-heading-xl">Cookies</h1>
    <p class="govuk-body">
      Cookies are small files saved on your phone, tablet or computer when you visit a website.
    </p>
    <p class="govuk-body">
      We use cookies to make ‘<%= service_name %>’ work and collect information about how you use our service.
    </p>

    <h3 class="govuk-heading-m" id="essential-cookies">Essential cookies</h3>

    <p class="govuk-body">
      Essential cookies keep your information secure while you use ‘<%= service_name %>’. We do not need to ask permission to use them.
    </p>

    <table class="govuk-table">
      <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th scope="col" class="govuk-table__header govuk-!-width-one-third">
          Name
        </th>
        <th scope="col" class="govuk-table__header govuk-!-width-one-third">
          Purpose
        </th>
        <th scope="col" class="govuk-table__header govuk-!-width-one-third">
          Expires
        </th>
      </tr>
      </thead>
      <tbody class="govuk-table__body">
      <tr class="govuk-table__row">
        <td class="govuk-table__cell">
          _apply_for_postgraduate<wbr>_teacher_training_session
        </td>
        <td class="govuk-table__cell">
          Stores encrypted session data
        </td>
        <td class="govuk-table__cell">
          When you close your browser
        </td>
      </tr>
      <tr>
        <td class="govuk-table__cell">
          <%= "consented-to-#{@application}-cookies" %>
        </td>
        <td class="govuk-table__cell">
          Saves your cookie consent settings
        </td>
        <td class="govuk-table__cell">
          6 months
        </td>
      </tr>
      <% if request.path == '/provider/cookies' -%>
      <tr>
        <td class="govuk-table__cell">
          __zlcmid
        </td>
        <td class="govuk-table__cell">
          Store customer ID for chat widget authentication
        </td>
        <td class="govuk-table__cell">
          365 days
        </td>
      </tr>
      <% end -%>
      </tbody>
    </table>

    <h3 class="govuk-heading-m" id="measuring-website-usage">Analytics cookies (optional)</h3>

    <p class="govuk-body">
      <% if FeatureFlag.active?(:ms_clarity) %>
        <%= "With your permission, we use Google Analytics and Microsoft Clarity to collect data about how you use #{service_name}. This information helps us improve our service." %>
      <% else %>
        <%= "With your permission, we use Google Analytics to collect data about how you use #{service_name}. This information helps us improve our service." %>
      <% end %>
    </p>
    <p class="govuk-body">
      These services are not allowed to use or share our analytics data with anyone.
    </p>
    <p class="govuk-body">
      The services store anonymised information about:
    </p>

    <ul class="govuk-list govuk-list--bullet">
      <li>how you got to ‘<%= service_name %>’</li>
      <li>the pages you visit on this site and how long you spend on them</li>
      <li>what you click on while you are visiting the site</li>
    </ul>

    <table class="govuk-table">
      <caption class="govuk-table__caption govuk-table__caption--s">
        Google Analytics cookies
      </caption>
      <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th scope="col" class="govuk-table__header govuk-!-width-one-third">
          Name
        </th>
        <th scope="col" class="govuk-table__header govuk-!-width-one-third">
          Purpose
        </th>
        <th scope="col" class="govuk-table__header govuk-!-width-one-third">
          Expires
        </th>
      </tr>
      </thead>
      <tbody class="govuk-table__body">
      <tr class="govuk-table__row">
        <td class="govuk-table__cell">
          _ga
        </td>
        <td class="govuk-table__cell">
          Distinguishes anonymous users
        </td>
        <td class="govuk-table__cell">
          2 years
        </td>
      </tr>
      <tr>
        <td class="govuk-table__cell">
          _gid
        </td>
        <td class="govuk-table__cell">
          Distinguishes anonymous users
        </td>
        <td class="govuk-table__cell">
          24 hours
        </td>
      </tr>
      <% if request.path == '/provider/cookies' %>
        <tr>
          <td class="govuk-table__cell">
            _gat_<%= @cookie_ga_code %>
          </td>
          <td class="govuk-table__cell">
            Tracks page interactions
          </td>
          <td class="govuk-table__cell">
            1 minute
          </td>
        </tr>
      <% else %>
        <tr>
          <td class="govuk-table__cell">
            _gat_gtag_<%= @cookie_ga_code %>
          </td>
          <td class="govuk-table__cell">
            Limits requests
          </td>
          <td class="govuk-table__cell">
            10 minutes
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>

    <% if FeatureFlag.active?(:ms_clarity) %>
      <table class="govuk-table">
        <caption class="govuk-table__caption govuk-table__caption--s">
          Microsoft Clarity cookies
        </caption>
        <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header govuk-!-width-one-third">
            Name
          </th>
          <th scope="col" class="govuk-table__header govuk-!-width-one-third">
            Purpose
          </th>
          <th scope="col" class="govuk-table__header govuk-!-width-one-third">
            Expires
          </th>
        </tr>
        </thead>
        <tbody class="govuk-table__body">
          <tr>
            <td class="govuk-table__cell">
              _clck
            </td>
            <td class="govuk-table__cell">
              Persists the Clarity User ID and preferences, unique to that site is attributed to the same user ID.
            </td>
            <td class="govuk-table__cell">
              6 months (for as long as you have consented for analytic cookies)
            </td>
          </tr>
          <tr>
            <td class="govuk-table__cell">
              _clsk
            </td>
            <td class="govuk-table__cell">
              Connects multiple page views by a user into a single Clarity session recording.
            </td>
            <td class="govuk-table__cell">
              6 months (for as long as you have consented for analytic cookies)
            </td>
          </tr>
          <tr>
            <td class="govuk-table__cell">
              MUID
            </td>
            <td class="govuk-table__cell">
              Identifies unique web browsers visiting Microsoft sites. These cookies are used for site analytics, and other operational purposes.
            </td>
            <td class="govuk-table__cell">
              6 months (for as long as you have consented for analytic cookies)
            </td>
          </tr>
        </tbody>
      </table>
    <% end %>

    <%= form_with model: @cookie_preferences, url: @cookie_settings_path, method: :post do |f| %>
      <%= f.govuk_collection_radio_buttons :consent,
        [%w[yes Yes], %w[no No]],
        :first,
        :last,
        inline: true,
        legend: { text: 'Do you want to accept cookies for analytics?', size: 's' } %>
      <%= f.govuk_submit 'Save cookie settings' %>
    <% end %>
  </div>
</div>
