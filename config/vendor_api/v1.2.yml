---
openapi: 3.0.0
info:
  version: v1.2
  title: Apply API
  contact:
    name: DfE
    email: becomingateacher@digital.education.gov.uk
  description: |
    API for DfE’s Apply for teacher training service.
    Endpoints with the `/applications` prefix are considered stable.
    Experimental endpoints prefixed with `/test-data` may change or be removed.
servers:
- description: Sandbox (test environment for vendors)
  url: https://sandbox.apply-for-teacher-training.service.gov.uk/api/v1
- description: Production
  url: https://www.apply-for-teacher-training.service.gov.uk/api/v1
paths:
  "/applications/{application_id}/notes/create":
    post:
      tags:
      - Note management
      summary: Create note
      description: |
        Creates a new note for this application.
        The `updated_at` timestamp will be set to the time of the API call.
        Its author details will be read from the attribution part of MetaData.
      parameters:
      - "$ref": "#/components/parameters/application_id"
      requestBody:
        description: Note details
        content:
          application/json:
            schema:
              type: object
              required:
                - meta
                - data
              properties:
                data:
                  "$ref": "#/components/schemas/CreateNote"
                meta:
                  "$ref": "#/components/schemas/MetaData"
      responses:
        '200':
          description: An application
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/SingleApplicationResponse"
        '401':
          "$ref": "#/components/responses/Unauthorized"
        '404':
          "$ref": "#/components/responses/NotFound"
        '422':
          "$ref": "#/components/responses/UnprocessableEntity"
components:
  schemas:
    ApplicationAttributes:
      type: object
      additionalProperties: false
      properties:
        notes:
          type: array
          items:
            "$ref": "#/components/schemas/Note"
    CreateNote:
      type: object
      additionalProperties: false
      required:
      - message
      properties:
        message:
          type: string
          description: The content of the note
          example: 'This candidate can only interview remotely'
          maxLength: 500
    Note:
      type: object
      additionalProperties: false
      required:
      - id
      - message
      - created_at
      - updated_at
      - author
      properties:
        id:
          type: string
          description: |
            The unique ID of this note. Automatically generated by our service.
          example: 123456
        message:
          type: string
          description: The content of the note
          example: 'This candidate can only interview remotely'
          maxLength: 500
        created_at:
          type: string
          format: date-time
          description: Date and time the original note was created
          example: 2019-09-18T15:33:49.216Z
        updated_at:
          type: string
          format: date-time
          description: Date and time the note was updated
          example: 2019-09-18T15:33:49.216Z
        author:
          type: string
          description: Author’s name
          example: John Smith

security:
- tokenAuth: []
